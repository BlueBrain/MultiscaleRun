#!/bin/bash

#SBATCH --job-name="multiscale_run"
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=32

#SBATCH --account=proj40
#SBATCH --partition=prod
#SBATCH --constraint=cpu
#SBATCH --time=02:00:00

#SBATCH --cpus-per-task=2
#SBATCH --exclusive
#SBATCH --mem=0
#SBATCH --output="%x-%j.log"



# add your favourite steps branch or leave it empty for master
#export steps_branch=master

source ./setup.sh

# parameters
#export with_steps=1
#export with_metabolism=1
export with_bloodflow=0

#export results_path=RESULTS/STEPS4

#export blueconfig_path=BlueConfig

#export steps_version=4
#export steps_mesh_path=steps_meshes/mc2c/mc2c.msh

#export bloodflow_path=bloodflow_src
#special_path=special # uncomment this to override which special you want to use

if [[ -z "${special_path}" ]]
then
  if [ -d "x86_64" ]
  then
    echo "use custom special"
    SPECIAL_PATH=x86_64/special
  else

    SPECIAL_PATH=special
  fi
fi

echo "SPECIAL_PATH="$SPECIAL_PATH

time srun dplace $SPECIAL_PATH -mpi -python main.py
